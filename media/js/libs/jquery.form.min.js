(function(a){function b(){if(a.fn.ajaxSubmit.debug&&window.console&&window.console.log)window.console.log("[jquery.form] "+Array.prototype.join.call(arguments,""))}a.fn.ajaxSubmit=function(c){function p(){function r(a,b){if(window.ActiveXObject){b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a)}else b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&b.documentElement.tagName!="parsererror"?b:null}function q(){if(l++)return;h.detachEvent?h.detachEvent("onload",q):h.removeEventListener("load",q,false);var b=true;try{if(m)throw"timeout";var c,e;e=h.contentWindow?h.contentWindow.document:h.contentDocument?h.contentDocument:h.document;if((e.body==null||e.body.innerHTML=="")&&!p){p=1;l--;setTimeout(q,100);return}i.responseText=e.body?e.body.innerHTML:null;i.responseXML=e.XMLDocument?e.XMLDocument:e;i.getResponseHeader=function(a){var b={"content-type":d.dataType};return b[a]};if(d.dataType=="json"||d.dataType=="script"){var f=e.getElementsByTagName("textarea")[0];i.responseText=f?f.value:i.responseText}else if(d.dataType=="xml"&&!i.responseXML&&i.responseText!=null){i.responseXML=r(i.responseText)}c=a.httpData(i,d.dataType)}catch(j){b=false;a.handleError(d,i,"error",j)}if(b){d.success(c,"success");if(k)a.event.trigger("ajaxSuccess",[i,d])}if(k)a.event.trigger("ajaxComplete",[i,d]);if(k&&!--a.active)a.event.trigger("ajaxStop");if(d.complete)d.complete(i,b?"success":"error");setTimeout(function(){g.remove();i.responseXML=null},100)}var b=j[0];if(a(":input[name=submit]",b).length){alert('Error: Form elements must not be named "submit".');return}var d=a.extend({},a.ajaxSettings,c);var e=a.extend(true,{},a.extend(true,{},a.ajaxSettings),d);var f="jqFormIO"+(new Date).getTime();var g=a('<iframe id="'+f+'" name="'+f+'" src="about:blank" />');var h=g[0];g.css({position:"absolute",top:"-1000px",left:"-1000px"});var i={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;g.attr("src","about:blank")}};var k=d.global;if(k&&!(a.active++))a.event.trigger("ajaxStart");if(k)a.event.trigger("ajaxSend",[i,d]);if(e.beforeSend&&e.beforeSend(i,e)===false){e.global&&a.active--;return}if(i.aborted)return;var l=0;var m=0;var n=b.clk;if(n){var o=n.name;if(o&&!n.disabled){c.extraData=c.extraData||{};c.extraData[o]=n.value;if(n.type=="image"){c.extraData[name+".x"]=b.clk_x;c.extraData[name+".y"]=b.clk_y}}}setTimeout(function(){var e=j.attr("target"),i=j.attr("action");b.setAttribute("target",f);if(b.getAttribute("method")!="POST")b.setAttribute("method","POST");if(b.getAttribute("action")!=d.url)b.setAttribute("action",d.url);if(!c.skipEncodingOverride){j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(d.timeout)setTimeout(function(){m=true;q()},d.timeout);var k=[];try{if(c.extraData)for(var l in c.extraData)k.push(a('<input type="hidden" name="'+l+'" value="'+c.extraData[l]+'" />').appendTo(b)[0]);g.appendTo("body");h.attachEvent?h.attachEvent("onload",q):h.addEventListener("load",q,false);b.submit()}finally{b.setAttribute("action",i);e?b.setAttribute("target",e):j.removeAttr("target");a(k).remove()}},10);var p=0;}if(!this.length){b("ajaxSubmit: skipping submit process - no element selected");return this}if(typeof c=="function")c={success:c};var d=this.attr("action")||window.location.href;d=(d.match(/^([^#]+)/)||[])[1];d=d||"";c=a.extend({url:d,type:this.attr("method")||"GET"},c||{});var e={};this.trigger("form-pre-serialize",[this,c,e]);if(e.veto){b("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(c.beforeSerialize&&c.beforeSerialize(this,c)===false){b("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var f=this.formToArray(c.semantic);if(c.data){c.extraData=c.data;for(var g in c.data){if(c.data[g]instanceof Array){for(var h in c.data[g])f.push({name:g,value:c.data[g][h]})}else f.push({name:g,value:c.data[g]})}}if(c.beforeSubmit&&c.beforeSubmit(f,this,c)===false){b("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[f,this,c,e]);if(e.veto){b("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var i=a.param(f);if(c.type.toUpperCase()=="GET"){c.url+=(c.url.indexOf("?")>=0?"&":"?")+i;c.data=null}else c.data=i;var j=this,k=[];if(c.resetForm)k.push(function(){j.resetForm()});if(c.clearForm)k.push(function(){j.clearForm()});if(!c.dataType&&c.target){var l=c.success||function(){};k.push(function(b){a(c.target).html(b).each(l,arguments)})}else if(c.success)k.push(c.success);c.success=function(a,b){for(var d=0,e=k.length;d<e;d++)k[d].apply(c,[a,b,j])};var m=a("input:file",this).fieldValue();var n=false;for(var o=0;o<m.length;o++)if(m[o])n=true;if(c.iframe||n){if(c.closeKeepAlive)a.get(c.closeKeepAlive,p);else p()}else a.ajax(c);this.trigger("form-submit-notify",[this,c]);return this;};a.fn.ajaxForm=function(b){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){a(this).ajaxSubmit(b);return false}).each(function(){a(":submit,input:image",this).bind("click.form-plugin",function(b){var c=this.form;c.clk=this;if(this.type=="image"){if(b.offsetX!=undefined){c.clk_x=b.offsetX;c.clk_y=b.offsetY}else if(typeof a.fn.offset=="function"){var d=a(this).offset();c.clk_x=b.pageX-d.left;c.clk_y=b.pageY-d.top}else{c.clk_x=b.pageX-this.offsetLeft;c.clk_y=b.pageY-this.offsetTop}}setTimeout(function(){c.clk=c.clk_x=c.clk_y=null},10)})})};a.fn.ajaxFormUnbind=function(){this.unbind("submit.form-plugin");return this.each(function(){a(":submit,input:image",this).unbind("click.form-plugin")})};a.fn.formToArray=function(b){var c=[];if(this.length==0)return c;var d=this[0];var e=b?d.getElementsByTagName("*"):d.elements;if(!e)return c;for(var f=0,g=e.length;f<g;f++){var h=e[f];var i=h.name;if(!i)continue;if(b&&d.clk&&h.type=="image"){if(!h.disabled&&d.clk==h)c.push({name:i+".x",value:d.clk_x},{name:i+".y",value:d.clk_y});continue}var j=a.fieldValue(h,true);if(j&&j.constructor==Array){for(var k=0,l=j.length;k<l;k++)c.push({name:i,value:j[k]})}else if(j!==null&&typeof j!="undefined")c.push({name:i,value:j})}if(!b&&d.clk){var m=d.getElementsByTagName("input");for(var f=0,g=m.length;f<g;f++){var n=m[f];var i=n.name;if(i&&!n.disabled&&n.type=="image"&&d.clk==n)c.push({name:i+".x",value:d.clk_x},{name:i+".y",value:d.clk_y})}}return c};a.fn.formSerialize=function(b){return a.param(this.formToArray(b))};a.fn.fieldSerialize=function(b){var c=[];this.each(function(){var d=this.name;if(!d)return;var e=a.fieldValue(this,b);if(e&&e.constructor==Array){for(var f=0,g=e.length;f<g;f++)c.push({name:d,value:e[f]})}else if(e!==null&&typeof e!="undefined")c.push({name:this.name,value:e})});return a.param(c)};a.fn.fieldValue=function(b){for(var c=[],d=0,e=this.length;d<e;d++){var f=this[d];var g=a.fieldValue(f,b);if(g===null||typeof g=="undefined"||g.constructor==Array&&!g.length)continue;g.constructor==Array?a.merge(c,g):c.push(g)}return c};a.fieldValue=function(a,b){var c=a.name,d=a.type,e=a.tagName.toLowerCase();if(typeof b=="undefined")b=true;if(b&&(!c||a.disabled||d=="reset"||d=="button"||(d=="checkbox"||d=="radio")&&!a.checked||(d=="submit"||d=="image")&&a.form&&a.form.clk!=a||e=="select"&&a.selectedIndex==-1))return null;if(e=="select"){var f=a.selectedIndex;if(f<0)return null;var g=[],h=a.options;var i=d=="select-one";var j=i?f+1:h.length;for(var k=i?f:0;k<j;k++){var l=h[k];if(l.selected){var m=l.value;if(!m)m=l.attributes&&l.attributes["value"]&&!l.attributes["value"].specified?l.text:l.value;if(i)return m;g.push(m)}}return g}return a.value};a.fn.clearForm=function(){return this.each(function(){a("input,select,textarea",this).clearFields()})};a.fn.clearFields=a.fn.clearInputs=function(){return this.each(function(){var a=this.type,b=this.tagName.toLowerCase();if(a=="text"||a=="password"||b=="textarea")this.value="";else if(a=="checkbox"||a=="radio")this.checked=false;else if(b=="select")this.selectedIndex=-1})};a.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)this.reset()})};a.fn.enable=function(a){if(a==undefined)a=true;return this.each(function(){this.disabled=!a})};a.fn.selected=function(b){if(b==undefined)b=true;return this.each(function(){var c=this.type;if(c=="checkbox"||c=="radio")this.checked=b;else if(this.tagName.toLowerCase()=="option"){var d=a(this).parent("select");if(b&&d[0]&&d[0].type=="select-one"){d.find("option").selected(false)}this.selected=b}})};})(jQuery)